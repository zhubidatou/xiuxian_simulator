<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰øÆ‰ªôÊ®°ÊãüÂô®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
            padding: 10px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 2px solid #ffd700;
            margin-bottom: 20px;
        }

        .header h1 {
            color: #ffd700;
            font-size: 1.8rem;
            text-shadow: 0 0 10px #ffd700;
        }

        .header .subtitle {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 5px;
        }

        .current-method {
            text-align: center;
            padding: 10px;
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05));
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #ffd700;
        }

        .current-method-label {
            font-size: 0.8rem;
            color: #aaa;
        }

        .current-method-value {
            color: #ffd700;
            font-size: 1.1rem;
            font-weight: bold;
        }

        .equipment-section {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }

        .equipment-title {
            color: #ffd700;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-align: center;
        }

        .bonus-display {
            font-size: 0.75rem;
            color: #aaa;
            text-align: center;
            margin-top: 8px;
            line-height: 1.4;
        }

        .bonus-display span {
            color: #4CAF50;
            font-weight: bold;
        }

        .equipped-slots {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .equip-slot {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #444;
            border-radius: 4px;
            padding: 8px 4px;
            text-align: center;
            font-size: 0.7rem;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-all;
        }

        .equip-slot.occupied {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4CAF50;
            color: #ffd700;
        }

        .equip-slot.empty {
            color: #666;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid #ffd700;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #aaa;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #fff;
        }

        .realm {
            grid-column: span 2;
            text-align: center;
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
        }

        .realm-value {
            color: #ffd700;
            font-size: 1.4rem;
        }

        .progress-bar {
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffaa00);
            transition: width 0.3s ease;
        }

        .health-fill {
            background: linear-gradient(90deg, #ff4444, #ff6666);
        }

        .age-fill {
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
        }

        .actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #fff;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .action-btn.cultivate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .action-btn.explore {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .action-btn.rest {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .action-btn.items {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .action-btn.methods {
            background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
        }

        .action-btn.practice {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .log {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #333;
        }

        .log-title {
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #333;
        }

        .log-entry {
            padding: 5px 0;
            font-size: 0.9rem;
            border-bottom: 1px solid #222;
        }

        .log-entry.good {
            color: #4CAF50;
        }

        .log-entry.bad {
            color: #f44336;
        }

        .log-entry.special {
            color: #ffd700;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #1a1a2e;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ffd700;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
            width: 95%;
        }

        .modal-title {
            color: #ffd700;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .item-list, .method-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .item, .method {
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .method.active {
            border: 2px solid #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-name, .method-name {
            font-weight: bold;
            color: #ffd700;
            font-size: 1.1rem;
        }

        .item-name.equipped {
            color: #4CAF50;
        }

        .item-desc, .method-desc {
            font-size: 0.85rem;
            color: #aaa;
            line-height: 1.4;
        }

        .item-effects {
            font-size: 0.85rem;
            color: #4CAF50;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }

        .use-btn, .equip-btn {
            background: #ffd700;
            color: #1a1a2e;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            flex: 1;
        }

        .equip-btn {
            background: #4CAF50;
        }

        .select-btn {
            background: #2196F3;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            flex: 1;
        }

        .close-btn {
            width: 100%;
            padding: 12px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            font-size: 1rem;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ffd700;
            color: #1a1a2e;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 1001;
            display: none;
            font-weight: bold;
            max-width: 300px;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .notification-content {
            font-size: 1rem;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .game-over {
            text-align: center;
            padding: 30px;
            background: rgba(255, 0, 0, 0.2);
            border-radius: 10px;
            border: 2px solid #f44336;
            margin: 20px 0;
        }

        .game-over h2 {
            color: #f44336;
            margin-bottom: 10px;
        }

        .restart-btn {
            background: #ffd700;
            color: #1a1a2e;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
        }

        .new-item-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 30px;
            z-index: 1002;
            text-align: center;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            display: none;
            max-width: 90%;
            animation: popIn 0.5s ease;
        }

        .new-item-alert.show {
            display: block;
        }

        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0.5);
                opacity: 0;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .alert-title {
            color: #ffd700;
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #ffd700;
        }

        .alert-item-name {
            color: #4CAF50;
            font-size: 1.3rem;
            font-weight: bold;
            margin: 15px 0;
        }

        .alert-item-desc {
            color: #aaa;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .alert-btn {
            background: #ffd700;
            color: #1a1a2e;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        .method-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .method-badge {
            background: #4CAF50;
            color: #fff;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
        }

        .event-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1003;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .event-modal.show {
            display: flex;
        }

        .event-content {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
            animation: eventPop 0.4s ease;
        }

        @keyframes eventPop {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .event-title {
            color: #ffd700;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .event-description {
            color: #e8e8e8;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            text-align: center;
        }

        .event-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .event-option {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border: 2px solid #667eea;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .event-option:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.5), rgba(118, 75, 162, 0.5));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .event-option:active {
            transform: translateY(0);
        }

        .event-option-text {
            color: #fff;
            font-size: 1rem;
            font-weight: bold;
        }

        .event-option-risk {
            color: #f44336;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .event-option-reward {
            color: #4CAF50;
            font-size: 0.8rem;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‰øÆ‰ªôÊ®°ÊãüÂô®</h1>
            <p class="subtitle">Âá°‰∫∫‰øÆ‰ªô‰º†</p>
        </div>

        <div class="current-method">
            <div class="current-method-label">ÂΩìÂâçÂäüÊ≥ï</div>
            <div class="current-method-value" id="current-method">Êó†</div>
        </div>

        <div class="equipment-section">
            <div class="equipment-title">Â∑≤Ë£ÖÂ§áÊ≥ïÂÆù (<span id="equipped-count">0</span>/10)</div>
            <div class="equipped-slots" id="equipment-slots">
            </div>
            <div class="bonus-display" id="bonus-display">
                ÂΩìÂâçÂä†ÊàêÔºöÊöÇÊó†Ë£ÖÂ§á
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">ÁîüÂëΩ</div>
                <div class="stat-value" id="health">100/100</div>
                <div class="progress-bar">
                    <div class="progress-fill health-fill" id="health-bar" style="width: 100%"></div>
                </div>
            </div>

            <div class="stat-item">
                <div class="stat-label">ÂØøÂÖÉ</div>
                <div class="stat-value" id="age">16Â≤Å</div>
                <div class="progress-bar">
                    <div class="progress-fill age-fill" id="age-bar" style="width: 16%"></div>
                </div>
            </div>

            <div class="stat-item">
                <div class="stat-label">‰øÆ‰∏∫</div>
                <div class="stat-value" id="cultivation">0</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="cultivation-bar" style="width: 0%"></div>
                </div>
            </div>

            <div class="stat-item">
                <div class="stat-label">Â®ÅÊúõ</div>
                <div class="stat-value" id="reputation">0</div>
            </div>

            <div class="stat-item realm">
                <div class="stat-label">Â¢ÉÁïå</div>
                <div class="stat-value realm-value" id="realm">Âá°‰∫∫</div>
            </div>
        </div>

        <div class="actions">
            <button class="action-btn cultivate" onclick="cultivate()">‰øÆÁÇºËá™Ë∫´</button>
            <button class="action-btn practice" onclick="practiceMethod()">‰øÆÁÇºÂäüÊ≥ï</button>
            <button class="action-btn explore" onclick="explore()">Êé¢Á¥¢</button>
            <button class="action-btn rest" onclick="rest()">Áñó‰º§</button>
            <button class="action-btn items" onclick="showItems()">Ê≥ïÂÆùËÉåÂåÖ</button>
            <button class="action-btn methods" style="grid-column: span 2;" onclick="showMethods()">ÂäüÊ≥ïÂõæÈâ¥</button>
        </div>

        <div class="log">
            <div class="log-title">‰øÆ‰ªôÊó•Âøó</div>
            <div id="log-content"></div>
        </div>
    </div>

    <div class="modal" id="items-modal">
        <div class="modal-content">
            <div class="modal-title">Ê≥ïÂÆùËÉåÂåÖ</div>
            <div class="item-list" id="items-list"></div>
            <button class="close-btn" onclick="closeModal('items-modal')">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <div class="modal" id="methods-modal">
        <div class="modal-content">
            <div class="modal-title">ÂäüÊ≥ïÂõæÈâ¥</div>
            <div class="method-list" id="methods-list"></div>
            <button class="close-btn" onclick="closeModal('methods-modal')">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <div class="notification" id="notification">
        <div class="notification-content"></div>
    </div>

    <div class="new-item-alert" id="new-item-alert">
        <div class="alert-title">üéâ ÊÅ≠ÂñúËé∑ÂæóÊñ∞ÂäüÊ≥ïÔºÅ</div>
        <div class="alert-item-name" id="alert-item-name"></div>
        <div class="alert-item-desc" id="alert-item-desc"></div>
        <button class="alert-btn" onclick="closeNewAlert()">Á°ÆÂÆö</button>
    </div>

    <div class="event-modal" id="event-modal">
        <div class="event-content">
            <div class="event-title" id="event-title"></div>
            <div class="event-description" id="event-description"></div>
            <div class="event-options" id="event-options"></div>
        </div>
    </div>

    <script>
        const gameState = {
            health: 100,
            maxHealth: 100,
            age: 16,
            maxAge: 150,
            cultivation: 0,
            maxCultivation: 100,
            reputation: 0,
            realm: 0,
            realmNames: ['Âá°‰∫∫', 'ÁÇºÊ∞îÊúü‰∏ÄÂ±Ç', 'ÁÇºÊ∞îÊúü‰∫åÂ±Ç', 'ÁÇºÊ∞îÊúü‰∏âÂ±Ç', 'ÁÇºÊ∞îÊúüÂõõÂ±Ç', 'ÁÇºÊ∞îÊúü‰∫îÂ±Ç', 
                        'ÁÇºÊ∞îÊúüÂÖ≠Â±Ç', 'ÁÇºÊ∞îÊúü‰∏ÉÂ±Ç', 'ÁÇºÊ∞îÊúüÂÖ´Â±Ç', 'ÁÇºÊ∞îÊúü‰πùÂ±Ç', 'ÁÇºÊ∞îÊúüÂúÜÊª°',
                        'Á≠ëÂü∫ÂàùÊúü', 'Á≠ëÂü∫‰∏≠Êúü', 'Á≠ëÂü∫ÂêéÊúü', 'Á≠ëÂü∫ÂúÜÊª°',
                        'Áªì‰∏πÂàùÊúü', 'Áªì‰∏π‰∏≠Êúü', 'Áªì‰∏πÂêéÊúü', 'Áªì‰∏πÂúÜÊª°',
                        'ÂÖÉÂ©¥ÂàùÊúü', 'ÂÖÉÂ©¥‰∏≠Êúü', 'ÂÖÉÂ©¥ÂêéÊúü', 'ÂÖÉÂ©¥Â§ßÂúÜÊª°',
                        'ÂåñÁ•ûÊúü', 'ÁÇºËôöÊúü', 'Âêà‰ΩìÊúü', 'Â§ß‰πòÊúü', 'Ê∏°Âä´Êúü', 'È£ûÂçá'],
            items: [],
            equippedItems: [],
            currentMethod: null,
            learnedMethods: [],
            methodLevels: {},
            isGameOver: false
        };

        const methodDatabase = [
            { id: 1, name: 'Âü∫Á°ÄÂêêÁ∫≥Ê≥ï', desc: 'ÊúÄÂü∫Á°ÄÁöÑÂÖ•Èó®ÂäüÊ≥ïÔºåÈÄÇÂêàÂàùÂ≠¶ËÄÖ‰øÆÁÇº', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+50%', 'ÂØøÂÖÉÊ∂àËÄó-20%'], cultivationBonus: 1.5, ageBonus: 0.8, healBonus: 1.2 },
            { id: 2, name: 'ÈïøÊò•Âäü', desc: 'Ê∏©ÂíåÂÖªÁîüÁöÑÂäüÊ≥ïÔºåÊ≥®ÈáçÂª∂Âπ¥ÁõäÂØø', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+40%', 'ÂØøÂÖÉÊ∂àËÄó-70%', 'Áñó‰º§ÊïàÊûú+60%', 'ÁîüÂëΩ‰∏äÈôê+80'], cultivationBonus: 1.4, ageBonus: 0.3, healBonus: 1.6, healthBonus: 80 },
            { id: 3, name: 'ÁÇº‰ΩìÂÜ≥', desc: 'Âº∫Ë∫´ÂÅ•‰ΩìÁöÑÁÇº‰ΩìÂäüÊ≥ïÔºåÊèêÂçáÁîüÂëΩ‰∏äÈôê', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+35%', 'ÁîüÂëΩ‰∏äÈôê+120', 'Âèó‰º§ÂáèÂ∞ë55%', 'Áñó‰º§ÊïàÊûú+40%'], cultivationBonus: 1.35, healthBonus: 120, defenseBonus: 0.45, healBonus: 1.4 },
            { id: 4, name: 'ËÅöÁÅµÂäü', desc: 'Ê±áËÅöÂ§©Âú∞ÁÅµÊ∞îÁöÑÂäüÊ≥ïÔºå‰øÆÁÇºÈÄüÂ∫¶Âø´', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+80%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+30%', 'Êé¢Á¥¢Êî∂Áõä+30%'], cultivationBonus: 1.8, breakthroughBonus: 1.3, exploreBonus: 1.3 },
            { id: 5, name: '‰∫îË°åÈÅÅÊúØ', desc: 'ÂåÖÂê´ÈáëÊú®Ê∞¥ÁÅ´Âúü‰∫îË°åÂÖÉÁ¥†ÁöÑÂäüÊ≥ï', effects: ['Êé¢Á¥¢Êî∂Áõä+80%', '‰øÆ‰∏∫Ëé∑Âèñ+50%', 'ÂØøÂÖÉÊ∂àËÄó-30%'], exploreBonus: 1.8, cultivationBonus: 1.5, ageBonus: 0.7 },
            { id: 6, name: 'ÈùíÂÖÉÂâëËØÄ', desc: 'ÈùíÂÖÉÈó®ÁªùÂ≠¶ÔºåÂâëÊ∞îÂáåÂéâ', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+70%', 'Êé¢Á¥¢Êî∂Áõä+75%', 'Â®ÅÊúõËé∑Âèñ+50%', 'Âèó‰º§ÂáèÂ∞ë20%'], cultivationBonus: 1.7, exploreBonus: 1.75, reputationBonus: 1.5, defenseBonus: 0.8 },
            { id: 7, name: 'Â§ßË°çÂÜ≥', desc: '‰øÆÁÇºÁ•ûÈ≠ÇÁöÑÁªù‰∏ñÂäüÊ≥ï', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+90%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+40%', 'Êé¢Á¥¢Êî∂Áõä+40%', 'Áñó‰º§ÊïàÊûú+30%'], cultivationBonus: 1.9, breakthroughBonus: 1.4, exploreBonus: 1.4, healBonus: 1.3 },
            { id: 8, name: '‰∏âËΩ¨ÈáçÂÖÉÂäü', desc: 'Âè§ÂÆùÊâÄÁÇºÂà∂ÁöÑÁâπÊÆäÂäüÊ≥ï', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+60%', 'Áñó‰º§ÊïàÊûú+80%', 'ÂØøÂÖÉÊ∂àËÄó-60%', 'ÁîüÂëΩ‰∏äÈôê+60'], cultivationBonus: 1.6, healBonus: 1.8, ageBonus: 0.4, healthBonus: 60 },
            { id: 9, name: 'Ê¢µÂú£ÁúüÈ≠îÂäü', desc: 'È≠îÈÅìÈ°∂Á∫ßÂäüÊ≥ïÔºåÂ®ÅÂäõÊÉä‰∫∫', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+120%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+50%', 'Êé¢Á¥¢Êî∂Áõä+50%', 'ÂØøÂÖÉÊ∂àËÄó-20%'], cultivationBonus: 2.2, breakthroughBonus: 1.5, exploreBonus: 1.5, ageBonus: 0.8 },
            { id: 10, name: 'ÂÖÉÁ£ÅÁ•ûÂÖâ', desc: 'Âà©Áî®ÂÖÉÁ£Å‰πãÂäõ‰øÆÁÇº', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+80%', 'Âèó‰º§ÂáèÂ∞ë50%', 'Êé¢Á¥¢Êî∂Áõä+70%', 'Áñó‰º§ÊïàÊûú+40%'], cultivationBonus: 1.8, defenseBonus: 0.5, exploreBonus: 1.7, healBonus: 1.4 },
            { id: 11, name: 'Â§ßÂ∫öÂâëÈòµ', desc: 'ÂâëÈòµÁ±ªÂäüÊ≥ïÔºåÊîªÂáªÂäõÂº∫Â§ß', effects: ['Êé¢Á¥¢Êî∂Áõä+120%', 'Â®ÅÊúõËé∑Âèñ+90%', '‰øÆ‰∏∫Ëé∑Âèñ+70%', 'Âèó‰º§ÂáèÂ∞ë25%'], exploreBonus: 2.2, reputationBonus: 1.9, cultivationBonus: 1.7, defenseBonus: 0.75 },
            { id: 12, name: 'ËæüÈÇ™Á•ûÈõ∑', desc: 'Èõ∑Â±ûÊÄßÂäüÊ≥ïÔºåÂÖãÂà∂È≠îÁâ©', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+90%', 'Êé¢Á¥¢Êî∂Áõä+100%', 'Âèó‰º§ÂáèÂ∞ë40%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+20%'], cultivationBonus: 1.9, exploreBonus: 2.0, defenseBonus: 0.6, breakthroughBonus: 1.2 },
            { id: 13, name: 'Á¥´Â∫úÁ•ûÂäü', desc: '‰øÆÁÇºÁ¥´Â∫úÂÖÉÂ©¥ÁöÑÊó†‰∏äÂäüÊ≥ï', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+110%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+50%', 'ÂØøÂÖÉÊ∂àËÄó-30%', 'Â®ÅÊúõËé∑Âèñ+40%'], cultivationBonus: 2.1, breakthroughBonus: 1.5, ageBonus: 0.7, reputationBonus: 1.4 },
            { id: 14, name: 'ÈùíÁ´πËúÇ‰∫ëÂâë', desc: 'ÂâëÈÅìÁªùÂ≠¶ÔºåÂâëÊ∞îÁ∫µÊ®™', effects: ['Êé¢Á¥¢Êî∂Áõä+130%', 'Â®ÅÊúõËé∑Âèñ+80%', '‰øÆ‰∏∫Ëé∑Âèñ+90%', 'Âèó‰º§ÂáèÂ∞ë30%'], exploreBonus: 2.3, reputationBonus: 1.8, cultivationBonus: 1.9, defenseBonus: 0.7 },
            { id: 15, name: 'ÁéÑÈ≠ÇÁÇºÂ¶ñÂÜ≥', desc: 'Âà©Áî®Â¶ñÂÖΩÁÅµÈ≠Ç‰øÆÁÇº', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+130%', 'Êé¢Á¥¢Êî∂Áõä+90%', 'ÂØøÂÖÉÊ∂àËÄó-25%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+30%'], cultivationBonus: 2.3, exploreBonus: 1.9, ageBonus: 0.75, breakthroughBonus: 1.3 },
            { id: 16, name: '‰∏ÉÂçÅ‰∫åÂú∞ÁÖûÊúØ', desc: 'Á•ûÈÄöÁ±ªÂäüÊ≥ïÔºåÂèòÂåñÊó†Á©∑', effects: ['Êé¢Á¥¢Êî∂Áõä+150%', 'Â®ÅÊúõËé∑Âèñ+110%', '‰øÆ‰∏∫Ëé∑Âèñ+100%', 'ÂØøÂÖÉÊ∂àËÄó-20%'], exploreBonus: 2.5, reputationBonus: 2.1, cultivationBonus: 2.0, ageBonus: 0.8 },
            { id: 17, name: 'ÁôæÈ¨ºÂ§úË°åÊúØ', desc: 'È¨ºÈÅìÂäüÊ≥ïÔºåËØ°ÂºÇËé´Êµã', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+140%', 'Êé¢Á¥¢Êî∂Áõä+110%', 'Âèó‰º§ÂáèÂ∞ë50%', 'Áñó‰º§ÊïàÊûú+60%'], cultivationBonus: 2.4, exploreBonus: 2.1, defenseBonus: 0.5, healBonus: 1.6 },
            { id: 18, name: 'Â§©È≠îÁ≠ñ', desc: 'Â§©È≠îÂäüÊ≥ïÔºåÂ®ÅÂäõÊó†Á©∑', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+180%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+70%', 'ÂØøÂÖÉÊ∂àËÄó-40%', 'Êé¢Á¥¢Êî∂Áõä+80%'], cultivationBonus: 2.8, breakthroughBonus: 1.7, ageBonus: 0.6, exploreBonus: 1.8 },
            { id: 19, name: '‰∏áË±°Âäü', desc: '‰∏áË±°ÂåÖÂÆπÔºåÈÅìÊ≥ïËá™ÁÑ∂', effects: ['‰øÆ‰∏∫Ëé∑Âèñ+150%', 'Áñó‰º§ÊïàÊûú+100%', 'ÂØøÂÖÉÊ∂àËÄó-50%', 'ÁîüÂëΩ‰∏äÈôê+100', 'Âèó‰º§ÂáèÂ∞ë35%'], cultivationBonus: 2.5, healBonus: 2.0, ageBonus: 0.5, healthBonus: 100, defenseBonus: 0.65 },
            { id: 20, name: 'Â∞è‰∫îË°åÂâëÈòµ', desc: '‰∫îË°åÂâëÈòµÁ±ªÂäüÊ≥ï', effects: ['Êé¢Á¥¢Êî∂Áõä+110%', '‰øÆ‰∏∫Ëé∑Âèñ+100%', 'Â®ÅÊúõËé∑Âèñ+70%', 'Á™ÅÁ†¥ÊàêÂäüÁéá+35%'], exploreBonus: 2.1, cultivationBonus: 2.0, reputationBonus: 1.7, breakthroughBonus: 1.35 }
        ];

        const itemDatabase = [
            { id: 1, name: 'ÈùíÊú®‰∏π', desc: 'ÊÅ¢Â§ç120ÁÇπÁîüÂëΩ', effect: 'health', value: 120 },
            { id: 2, name: 'ËÅöÊ∞î‰∏π', desc: 'Â¢ûÂä†200ÁÇπ‰øÆ‰∏∫', effect: 'cultivation', value: 200 },
            { id: 3, name: 'Âª∂ÂØø‰∏π', desc: 'Â¢ûÂä†30Âπ¥ÂØøÂÖÉ', effect: 'age', value: 30 },
            { id: 4, name: 'È£ûÂâë', desc: 'ÊîªÂáªÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+80%', effect: 'equip', exploreBonus: 1.8 },
            { id: 5, name: 'Êä§ÂøÉÈïú', desc: 'Èò≤Êä§Ê≥ïÂÆùÔºåÂèó‰º§ÂáèÂ∞ë65%', effect: 'equip', defenseBonus: 0.35 },
            { id: 6, name: 'ÁÅµÁü≥', desc: 'ÁèçË¥µË¥ßÂ∏ÅÔºåÂ®ÅÊúõ+120', effect: 'wealth', reputationBonus: 120 },
            { id: 7, name: 'Á≠ëÂü∫‰∏π', desc: 'Á™ÅÁ†¥Á≠ëÂü∫ÊúüÂøÖÂ§áÔºåÁ™ÅÁ†¥ÊàêÂäüÁéá+80%', effect: 'equip', breakthroughBonus: 1.8 },
            { id: 8, name: 'ÁªìÈáë‰∏π', desc: 'Á™ÅÁ†¥Áªì‰∏πÊúüÂøÖÂ§áÔºåÁ™ÅÁ†¥ÊàêÂäüÁéá+90%', effect: 'equip', breakthroughBonus: 1.9 },
            { id: 9, name: 'ÂÖÉÂ©¥‰∏π', desc: 'Á™ÅÁ†¥ÂÖÉÂ©¥ÊúüÂøÖÂ§áÔºåÁ™ÅÁ†¥ÊàêÂäüÁéá+100%', effect: 'equip', breakthroughBonus: 2.0 },
            { id: 10, name: 'Ê∑∑ÂÖÉÈáëÊñó', desc: 'È°∂Á∫ßÊ≥ïÂÆùÔºå‰øÆ‰∏∫Ëé∑Âèñ+100%', effect: 'equip', cultivationBonus: 2.0 },
            { id: 11, name: 'ÈáëËõüÂâ™', desc: 'ÊîªÂáªÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+100%', effect: 'equip', exploreBonus: 2.0 },
            { id: 12, name: 'ÁøªÂ§©Âç∞', desc: 'ÊîªÂáªÊ≥ïÂÆùÔºåÂ®ÅÊúõËé∑Âèñ+100%', effect: 'equip', reputationBonus: 2.0 },
            { id: 13, name: '‰πùÈæôÁ•ûÁÅ´ÁΩ©', desc: 'Èò≤Êä§Ê≥ïÂÆùÔºåÂèó‰º§ÂáèÂ∞ë75%', effect: 'equip', defenseBonus: 0.25 },
            { id: 14, name: 'Â§™ÊûÅÂõæ', desc: 'È°∂Á∫ßÊ≥ïÂÆùÔºåÂÖ®Â±ûÊÄßÊèêÂçá+80%', effect: 'equip', allBonus: 1.8 },
            { id: 15, name: 'ÈùíÁ´πËúÇ‰∫ëÂâë', desc: 'ÂâëÊ≥ïÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+90%', effect: 'equip', exploreBonus: 1.9 },
            { id: 16, name: 'Á•ûÈ£éËàü', desc: 'È£ûË°åÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+85%', effect: 'equip', exploreBonus: 1.85 },
            { id: 17, name: 'ËæüÈÇ™Á•ûÈõ∑', desc: 'Èõ∑Â±ûÊÄßÊ≥ïÂÆùÔºåÂ®ÅÊúõËé∑Âèñ+95%', effect: 'equip', reputationBonus: 1.95 },
            { id: 18, name: 'Á¥´ÁîµÈúúÂçéÂâë', desc: 'Ââë‰∏≠ÊûÅÂìÅÔºå‰øÆ‰∏∫Ëé∑Âèñ+95%', effect: 'equip', cultivationBonus: 1.95 },
            { id: 19, name: '‰πæÂù§Âúà', desc: 'Èò≤Êä§Ê≥ïÂÆùÔºåÁîüÂëΩ‰∏äÈôê+150', effect: 'equip', healthBonus: 150 },
            { id: 20, name: 'Ê∑∑Â§©Áª´', desc: 'Èò≤Êä§Ê≥ïÂÆùÔºåÂèó‰º§ÂáèÂ∞ë70%', effect: 'equip', defenseBonus: 0.3 },
            { id: 21, name: 'ÂÖÉÁ£ÅÁ•ûÂ±±', desc: 'ÊîªÂáªÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+110%', effect: 'equip', exploreBonus: 2.1 },
            { id: 22, name: 'Â§ßË°çÂÜ≥', desc: 'ÁâπÊÆäÊ≥ïÂÆùÔºå‰øÆ‰∏∫Ëé∑Âèñ+90%', effect: 'equip', cultivationBonus: 1.9 },
            { id: 23, name: 'ËôöÂ§©Èºé', desc: 'ÈºéÁ±ªÊ≥ïÂÆùÔºåÂ®ÅÊúõËé∑Âèñ+110%', effect: 'equip', reputationBonus: 2.1 },
            { id: 24, name: 'ÂÖ´ËçíÁÅ´Èæô', desc: 'ÁÅ´Â±ûÊÄßÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+95%', effect: 'equip', exploreBonus: 1.95 },
            { id: 25, name: 'ÈªëÁÖûÊóó', desc: 'È≠îÈÅìÊ≥ïÂÆùÔºåÂ®ÅÊúõËé∑Âèñ+100%', effect: 'equip', reputationBonus: 2.0 },
            { id: 26, name: '‰∫îÈæôÈì°', desc: 'ÊîªÂáªÊ≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+90%', effect: 'equip', exploreBonus: 1.9 },
            { id: 27, name: 'ÂúüÈÅÅÁ¨¶', desc: 'ËæÖÂä©Ê≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+80%', effect: 'equip', exploreBonus: 1.8 },
            { id: 28, name: 'ËÅöÁÅµÈòµ', desc: 'ÈòµÊ≥ïÊ≥ïÂÆùÔºå‰øÆ‰∏∫Ëé∑Âèñ+85%', effect: 'equip', cultivationBonus: 1.85 },
            { id: 29, name: 'Â∞èÊå™Áßª‰ª§', desc: 'Á©∫Èó¥Ê≥ïÂÆùÔºåÊé¢Á¥¢Êî∂Áõä+120%', effect: 'equip', exploreBonus: 2.2 },
            { id: 30, name: 'ÈùíÂÜ•Èíà', desc: 'ÊöóÂô®Ê≥ïÂÆùÔºåÂ®ÅÊúõËé∑Âèñ+90%', effect: 'equip', reputationBonus: 1.9 }
        ];

        const interactiveEvents = [
            {
                title: 'Âèó‰º§ÁöÑ‰øÆ‰ªôËÄÖ',
                description: '‰Ω†ÈÅáÂà∞‰∏Ä‰∏™ÊµëË∫´ÊòØË°ÄÁöÑ‰øÆ‰ªôËÄÖÂÄíÂú®Âú∞‰∏äÔºå‰ºº‰πéÈÅ≠ÈÅá‰∫Ü‰ºèÂáª„ÄÇ',
                options: [
                    {
                        text: 'Âá∫ÊâãÁõ∏Âä©',
                        reward: { cultivation: 150, reputation: 50 },
                        risk: { health: 10 },
                        riskText: 'ÂèØËÉΩË¢´‰ªáÂÆ∂ÂèëÁé∞',
                        rewardText: 'Ëé∑ÂæóÂ§ßÈáè‰øÆ‰∏∫ÂíåÂ®ÅÊúõ',
                        message: '‰Ω†ÊàêÂäüÊïëÂä©‰∫ÜËøô‰Ωç‰øÆ‰ªôËÄÖÔºå‰ªñÊÑüÊøÄÂú∞Ëµ†ÈÄÅ‰Ω†‰∏ÄÊú¨ÁßòÁ±çÔºå‰øÆ‰∏∫Â§ßÂ¢ûÔºÅ'
                    },
                    {
                        text: 'ÁΩÆ‰πã‰∏çÁêÜ',
                        reward: { cultivation: 50 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Ëé∑ÂæóÂ∞ëÈáè‰øÆ‰∏∫',
                        message: '‰Ω†ÈÄâÊã©Á¶ªÂºÄÔºåÁªßÁª≠Ëá™Â∑±ÁöÑ‰øÆÁÇº‰πãË∑Ø„ÄÇ'
                    },
                    {
                        text: 'Ë∂ÅÊú∫Êä¢Âä´',
                        reward: { reputation: 100 },
                        risk: { health: 40 },
                        riskText: 'ÂèØËÉΩË¢´ÂèçÂô¨',
                        rewardText: 'Ëé∑ÂæóÂ§ßÈáèÂ®ÅÊúõ',
                        message: '‰Ω†ÊêúÂàÆ‰∫Ü‰ªñÁöÑÂÇ®Áâ©Ë¢ãÔºåËé∑Âæó‰∏çÂ∞ëÂÆùÁâ©ÔºÅ'
                    }
                ]
            },
            {
                title: 'Á•ûÁßòÊ¥ûÂ∫ú',
                description: '‰Ω†ÂèëÁé∞‰∫Ü‰∏ÄÂ§ÑÈöêËîΩÁöÑÂè§Ê¥ûÂ∫úÔºåÊ¥ûÂè£ÊúâÁ¶ÅÂà∂Èó™ÁÉÅÔºå‰ºº‰πéÊúâ‰∫∫Âú®ÈáåÈù¢‰øÆÁÇº„ÄÇ',
                options: [
                    {
                        text: 'Âº∫Ë°åÁ™ÅÁ†¥',
                        reward: { cultivation: 200, method: true },
                        risk: { health: 50, cultivation: 30 },
                        riskText: 'Á¶ÅÂà∂ÂèçÂô¨ÔºåÂèØËÉΩÈáç‰º§',
                        rewardText: 'ÊúâÊú∫‰ºöËé∑ÂæóÈ°∂Á∫ßÂäüÊ≥ï',
                        message: '‰Ω†ÂÜ≤Á†¥‰∫ÜÁ¶ÅÂà∂ÔºåÂèëÁé∞‰∫ÜÂâç‰∫∫Áïô‰∏ãÁöÑ‰º†ÊâøÔºÅ'
                    },
                    {
                        text: 'ÂØªÊâæÂÖ∂‰ªñÂÖ•Âè£',
                        reward: { cultivation: 100, reputation: 30 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Á®≥Â¶•Ëé∑ÂæóÂ•ñÂä±',
                        message: '‰Ω†ÁªïÈÅìÊâæÂà∞‰∫ÜÂÖ•Âè£ÔºåËé∑Âæó‰∫Ü‰∏Ä‰∫õÁÅµËçâ„ÄÇ'
                    },
                    {
                        text: 'ÊîæÂºÉÁ¶ªÂºÄ',
                        reward: { health: 20 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'ÊÅ¢Â§çÂ∞ëÈáèÁîüÂëΩ',
                        message: '‰Ω†ÂÜ≥ÂÆö‰∏çÊâìÊâ∞‰ªñ‰∫∫ÔºåÁªßÁª≠Ëµ∂Ë∑Ø„ÄÇ'
                    }
                ]
            },
            {
                title: 'Â¶ñÂÖΩÂπºÂ¥Ω',
                description: '‰Ω†ÈÅáÂà∞‰∏ÄÂè™Âèó‰º§ÁöÑÂ¶ñÂÖΩÂπºÂ¥ΩÔºåÂÆÉË≠¶ÊÉïÂú∞ÁúãÁùÄ‰Ω†ÔºåÂë®Âõ¥Ê≤°ÊúâÊØçÂÖΩÁöÑË∫´ÂΩ±„ÄÇ',
                options: [
                    {
                        text: 'Êî∂ÂÖªÈ©ØÂåñ',
                        reward: { item: true, reputation: 80 },
                        risk: { health: 25 },
                        riskText: 'ÂπºÂ¥ΩÂèØËÉΩÊîªÂáª',
                        rewardText: 'Ëé∑ÂæóÊ≥ïÂÆùÂíåÂ®ÅÊúõ',
                        message: '‰Ω†ÊàêÂäüÈ©ØÂåñ‰∫ÜÂÆÉÔºåËé∑Âæó‰∫Ü‰∏Ä‰ª∂Ê≥ïÂÆùÔºÅ'
                    },
                    {
                        text: 'Êñ©ÊùÄÂèñ‰∏π',
                        reward: { cultivation: 120, health: 30 },
                        risk: { reputation: 20 },
                        riskText: 'Â®ÅÊúõÈôç‰Ωé',
                        rewardText: 'Ëé∑ÂæóÂ§ßÈáè‰øÆ‰∏∫ÂíåÊ≤ªÁñó',
                        message: '‰Ω†ÂèñËµ∞‰∫ÜÂ¶ñ‰∏πÔºå‰øÆ‰∏∫ÊèêÂçá„ÄÇ'
                    },
                    {
                        text: 'ÊîæÁîüÁ¶ªÂºÄ',
                        reward: { reputation: 60 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Ëé∑ÂæóÂ®ÅÊúõ',
                        message: '‰Ω†ÈÄâÊã©‰∫Ü‰ªÅÊÖàÔºå‰øÆ‰ªôË∑ØÊº´Êº´Ôºå‰∏çÂÅöÊÅ∂‰∫ã„ÄÇ'
                    }
                ]
            },
            {
                title: 'ÁßòÂ¢ÉÊú∫Áºò',
                description: '‰Ω†ËØØÂÖ•‰∏ÄÂ§ÑÁßòÂ¢ÉÔºåÁúºÂâçÂá∫Áé∞‰∫Ü‰∏ÄÂ∫ßÂè§ËÄÅÁöÑÁ•≠ÂùõÔºåÁ•≠Âùõ‰∏äÊîæÁùÄ‰∏â‰ª∂ÂÆùÁâ©„ÄÇ',
                options: [
                    {
                        text: 'ÊãøÂèñÈáëËâ≤ÂÆùÁâ©',
                        reward: { cultivation: 180, method: true },
                        risk: { health: 35 },
                        riskText: 'Á•≠ÂùõÂèØËÉΩÊä§‰∏ª',
                        rewardText: 'Ëé∑ÂæóÈ°∂Á∫ßÂäüÊ≥ï',
                        message: 'ÈáëËâ≤ÂÆùÁâ©Âåñ‰Ωú‰∏ÄÈÅìÂäüÊ≥ïËûçÂÖ•‰Ω†ÁöÑËÑëÊµ∑ÔºÅ'
                    },
                    {
                        text: 'ÊãøÂèñËìùËâ≤ÂÆùÁâ©',
                        reward: { item: true, reputation: 60 },
                        risk: { health: 15 },
                        riskText: 'ËΩªÂæÆÂèçÂô¨',
                        rewardText: 'Ëé∑ÂæóÊ≥ïÂÆù',
                        message: 'ËìùËâ≤ÂÆùÁâ©ÂèòÊàê‰∫Ü‰∏Ä‰ª∂Ê≥ïÂÆùÔºÅ'
                    },
                    {
                        text: 'ÊãøÂèñÁªøËâ≤ÂÆùÁâ©',
                        reward: { health: 80, cultivation: 60 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Â§ßÈáèÊ≤ªÁñóÂíå‰øÆ‰∏∫',
                        message: 'ÁªøËâ≤ÂÆùÁâ©Âåñ‰ΩúËçØÂäõÔºå‰Ω†ÊÑüËßâË∫´‰ΩìÂ§ßÂ•Ω„ÄÇ'
                    }
                ]
            },
            {
                title: 'È≠î‰øÆ‰∫§Êòì',
                description: '‰∏Ä‰∏™ÈªëË°£‰∫∫Êã¶‰Ωè‰Ω†Ôºå‰ªñËá™Áß∞ÊòØÈ≠î‰øÆÔºåÊÑøÊÑèÁî®ÂäüÊ≥ï‰∫§Êç¢‰Ω†ÁöÑ‰øÆ‰∏∫„ÄÇ',
                options: [
                    {
                        text: '‰∫§Êç¢ÂäüÊ≥ï',
                        reward: { method: true, cultivation: 100 },
                        risk: { cultivation: 80 },
                        riskText: 'Ê∂àËÄóÂ§ßÈáè‰øÆ‰∏∫',
                        rewardText: 'Ëé∑ÂæóÈ≠îÈÅìÂäüÊ≥ï',
                        message: '‰ªñ‰º†Êéà‰∫Ü‰Ω†‰∏ÄÈó®È≠îÈÅìÂäüÊ≥ïÔºå‰øÆ‰∏∫ËôΩÊúâÊ∂àËÄóÔºå‰ΩÜÂÄºÂæó„ÄÇ'
                    },
                    {
                        text: 'ÊãíÁªùÂπ∂ÊîªÂáª',
                        reward: { reputation: 100, cultivation: 50 },
                        risk: { health: 45 },
                        riskText: 'ÂèØËÉΩÂèó‰º§',
                        rewardText: 'Â®ÅÊúõÂíå‰øÆ‰∏∫ÊèêÂçá',
                        message: '‰Ω†ÂáªË¥•‰∫ÜÈ≠î‰øÆÔºåÊ≠£ÈÇ™‰∏ç‰∏§Á´ãÔºÅ'
                    },
                    {
                        text: 'Ëôö‰∏éÂßîËõá',
                        reward: { reputation: 40 },
                        risk: { cultivation: 20 },
                        riskText: 'Ê∂àËÄóÂ∞ëÈáè‰øÆ‰∏∫',
                        rewardText: 'Ëé∑ÂæóÂ∞ëÈáèÂ®ÅÊúõ',
                        message: '‰Ω†Â∑ßÂ¶ôÂú∞ËÑ±Ë∫´Ôºå‰øÆ‰∏∫ÊúâÊâÄÊçüÂ§±„ÄÇ'
                    }
                ]
            },
            {
                title: 'Â§©Âä´Èôç‰∏¥',
                description: '‰Ω†ÊÑüÂà∞Â§©Á©∫ÂºÇÂèòÔºåÈõ∑‰∫ëÂØÜÂ∏ÉÔºå‰ºº‰πéÊúâ‰∫∫Âú®Ê≠§Ê∏°Âä´ÔºåÂ§©Âä´‰πãÂäõÊ≥¢ÂèäÂà∞‰∫Ü‰Ω†„ÄÇ',
                options: [
                    {
                        text: 'Á°¨ÊäóÂ§©Âä´',
                        reward: { cultivation: 250, reputation: 100 },
                        risk: { health: 60, cultivation: 50 },
                        riskText: 'ÂèØËÉΩÈáç‰º§‰∏î‰øÆ‰∏∫ÂÄíÈÄÄ',
                        rewardText: 'Â§ßÈáè‰øÆ‰∏∫ÂíåÂ®ÅÊúõ',
                        message: '‰Ω†Á°¨Êäó‰ΩèÂ§©Âä´ÔºåËôΩÁÑ∂Âèó‰º§Ôºå‰ΩÜ‰øÆ‰∏∫Â§ßËøõÔºÅ'
                    },
                    {
                        text: 'Ë∫≤ÈÅøÂ§©Âä´',
                        reward: {},
                        risk: { health: 30 },
                        riskText: '‰ªçÂèØËÉΩÂèó‰º§',
                        rewardText: 'Êó†Â•ñÂä±',
                        message: '‰Ω†Ë∫≤‰∫ÜËµ∑Êù•Ôºå‰ΩÜËøòÊòØË¢´Ê≥¢ÂèäÂèó‰∫ÜËΩª‰º§„ÄÇ'
                    },
                    {
                        text: 'Ë∂ÅÊú∫‰øÆÁÇº',
                        reward: { cultivation: 150 },
                        risk: { health: 50, cultivation: 30 },
                        riskText: 'Âèó‰º§‰∏î‰øÆ‰∏∫ÂèØËÉΩÂÄíÈÄÄ',
                        rewardText: 'Â§ßÈáè‰øÆ‰∏∫',
                        message: '‰Ω†Âà©Áî®Â§©Âä´‰πãÂäõ‰øÆÁÇºÔºåËôΩÊúâÊçü‰º§‰ΩÜÊî∂Ëé∑È¢á‰∏∞„ÄÇ'
                    }
                ]
            },
            {
                title: '‰∏äÂè§ÊàòÂú∫',
                description: '‰Ω†ÂèëÁé∞‰∫Ü‰∏ÄÂ§Ñ‰∏äÂè§ÊàòÂú∫ÁöÑÈÅóËøπÔºåÊÆãÂû£Êñ≠Â£ÅÈó¥ÈöêÁ∫¶ÂèØËßÅÂÆùÂÖâÈó™ÁÉÅ„ÄÇ',
                options: [
                    {
                        text: 'Ê∑±ÂÖ•Êé¢Á¥¢',
                        reward: { item: true, method: true, cultivation: 100 },
                        risk: { health: 55, cultivation: 40 },
                        riskText: 'ÂèØËÉΩËß¶ÂèëÁ¶ÅÂà∂',
                        rewardText: 'Ëé∑ÂæóÊ≥ïÂÆù„ÄÅÂäüÊ≥ïÂíå‰øÆ‰∏∫',
                        message: '‰Ω†ÂèëÁé∞‰∫ÜÂâç‰∫∫ÁöÑ‰º†ÊâøÔºåÊî∂Ëé∑Êª°Êª°ÔºÅ'
                    },
                    {
                        text: 'Â§ñÂõ¥ÊêúÁ¥¢',
                        reward: { item: true, cultivation: 60 },
                        risk: { health: 20 },
                        riskText: 'ËΩªÂæÆÈ£éÈô©',
                        rewardText: 'Ëé∑ÂæóÊ≥ïÂÆùÂíå‰øÆ‰∏∫',
                        message: '‰Ω†Âú®Â§ñÂõ¥ÊâæÂà∞‰∫Ü‰∏Ä‰∫õÂÆùÁâ©„ÄÇ'
                    },
                    {
                        text: 'ËßÇÊúõÂêéÁ¶ªÂºÄ',
                        reward: { health: 10 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Â∞ëÈáèÊ≤ªÁñó',
                        message: '‰Ω†ÈÄâÊã©Ë∞®ÊÖéË°å‰∫ãÔºåÁªßÁª≠Ëµ∂Ë∑Ø„ÄÇ'
                    }
                ]
            },
            {
                title: 'ÂÆóÈó®ÊãõÂãü',
                description: '‰∏Ä‰ΩçÂÆóÈó®‰ΩøËÄÖÈÇÄËØ∑‰Ω†Âä†ÂÖ•‰ªñ‰ª¨ÁöÑÈó®Ê¥æÔºåÊâøËØ∫Áªô‰Ω†ÂäüÊ≥ïÂíåËµÑÊ∫ê„ÄÇ',
                options: [
                    {
                        text: 'Âä†ÂÖ•ÂÆóÈó®',
                        reward: { method: true, cultivation: 80, reputation: 80 },
                        risk: { age: 5 },
                        riskText: 'ÂÆóÈó®ËßÑÁü©ÔºåÊ∂àËÄóÂØøÂÖÉ',
                        rewardText: 'Ëé∑ÂæóÂäüÊ≥ï„ÄÅ‰øÆ‰∏∫ÂíåÂ®ÅÊúõ',
                        message: '‰Ω†Âä†ÂÖ•‰∫ÜÂÆóÈó®ÔºåËé∑Âæó‰∫ÜËâØÂ•ΩÁöÑ‰øÆÁÇºËµÑÊ∫ê„ÄÇ'
                    },
                    {
                        text: 'ÊãíÁªùÂπ∂Á¶ªÂºÄ',
                        reward: { cultivation: 40 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Ëé∑ÂæóÂ∞ëÈáè‰øÆ‰∏∫',
                        message: '‰Ω†ÈÄâÊã©Áã¨Ëá™‰øÆÁÇºÔºå‰∏çÂèóÊùüÁºö„ÄÇ'
                    },
                    {
                        text: 'Á¥¢Ë¶ÅÂ•ΩÂ§ÑÂêéÂä†ÂÖ•',
                        reward: { method: true, item: true, cultivation: 100 },
                        risk: { reputation: 30, age: 8 },
                        riskText: 'ÂêçÂ£∞ÂèóÊçüÔºåÊ∂àËÄóÊõ¥Â§öÂØøÂÖÉ',
                        rewardText: 'Ëé∑ÂæóÂäüÊ≥ï„ÄÅÊ≥ïÂÆùÂíå‰øÆ‰∏∫',
                        message: '‰Ω†ÊàêÂäüÁ¥¢Ë¶Å‰∫ÜÂ•ΩÂ§ÑÔºå‰ΩÜÂêçÂ£∞Áï•ÊúâÂèóÊçü„ÄÇ'
                    }
                ]
            },
            {
                title: 'ÁßòÂ¢ÉËØïÁÇº',
                description: '‰Ω†ÂèëÁé∞‰∫Ü‰∏ÄÂ§ÑËØïÁÇº‰πãÂú∞ÔºåÂÖ•Âè£ÂÜôÁùÄ"ÈÄöËøáËØïÁÇºËÄÖÂèØÂæó‰ªôÁºò"„ÄÇ',
                options: [
                    {
                        text: 'Êé•ÂèóËØïÁÇº',
                        reward: { method: true, cultivation: 200, reputation: 100 },
                        risk: { health: 45, cultivation: 30 },
                        riskText: 'ËØïÁÇºÂ§±Ë¥•ÂèØËÉΩÂèó‰º§',
                        rewardText: 'Ëé∑ÂæóÈ°∂Á∫ßÂäüÊ≥ï„ÄÅÂ§ßÈáè‰øÆ‰∏∫ÂíåÂ®ÅÊúõ',
                        message: '‰Ω†ÊàêÂäüÈÄöËøáËØïÁÇºÔºåËé∑Âæó‰∫Ü‰º†ÊâøÔºÅ'
                    },
                    {
                        text: 'ËßÇÂØüÂêéÁ¶ªÂºÄ',
                        reward: { cultivation: 50 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Ëé∑ÂæóÂ∞ëÈáè‰øÆ‰∏∫',
                        message: '‰Ω†ÈÄâÊã©‰∫ÜÁ®≥Â¶•Ë°å‰∫ã„ÄÇ'
                    },
                    {
                        text: 'ÂØªÊâæÂÖ∂‰ªñÊú∫‰ºö',
                        reward: { item: true, reputation: 40 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: 'Ëé∑ÂæóÊ≥ïÂÆùÂíåÂ®ÅÊúõ',
                        message: '‰Ω†Âú®ËØïÁÇº‰πãÂú∞Â§ñÂèëÁé∞‰∫Ü‰∏Ä‰∫õÂÆùÁâ©„ÄÇ'
                    }
                ]
            },
            {
                title: 'Á•ûÂÖΩÂπºÂ¥Ω',
                description: '‰Ω†ÈÅáÂà∞‰∏ÄÂè™ÂπºÂ∞èÁöÑÁ•ûÂÖΩÔºåÂÆÉ‰ºº‰πéÂàöÂàöÁ†¥Â£≥ËÄåÂá∫ÔºåËôöÂº±Âú∞ÊúõÁùÄ‰Ω†„ÄÇ',
                options: [
                    {
                        text: 'Á≤æÂøÉÁÖßÊñô',
                        reward: { item: true, health: 60, reputation: 100 },
                        risk: { age: 3 },
                        riskText: 'Ê∂àËÄóÂØøÂÖÉ',
                        rewardText: 'Ëé∑ÂæóÈ°∂Á∫ßÊ≥ïÂÆù„ÄÅÊ≤ªÁñóÂíåÂ®ÅÊúõ',
                        message: 'Á•ûÂÖΩÈïøÂ§ßÂêéËµ†ÈÄÅ‰Ω†‰∫Ü‰∏Ä‰ª∂Ê≥ïÂÆùÔºÅ'
                    },
                    {
                        text: 'Á´ãÂç≥Êñ©ÊùÄ',
                        reward: { cultivation: 150, health: 40 },
                        risk: { reputation: 50 },
                        riskText: 'Â®ÅÊúõÂ§ßÂπÖÈôç‰Ωé',
                        rewardText: 'Â§ßÈáè‰øÆ‰∏∫ÂíåÊ≤ªÁñó',
                        message: '‰Ω†Ëé∑Âæó‰∫ÜÁ•ûÂÖΩÁöÑÂÜÖ‰∏πÔºå‰ΩÜÂêçÂ£∞ÂèóÊçü„ÄÇ'
                    },
                    {
                        text: 'ÊîæÁîüÁ•ùÁ¶è',
                        reward: { cultivation: 80, reputation: 120 },
                        risk: {},
                        riskText: 'Êó†È£éÈô©',
                        rewardText: '‰øÆ‰∏∫ÂíåÂ§ßÈáèÂ®ÅÊúõ',
                        message: 'Á•ûÂÖΩ‰∏¥Ëµ∞ÂâçÁªô‰∫Ü‰Ω†‰∏ÄÈÅìÁ•ùÁ¶èÔºå‰øÆ‰∏∫ÊèêÂçá„ÄÇ'
                    }
                ]
            }
        ];

        const randomEvents = [
            { text: 'ÈÅáÂà∞‰∏Ä‰∏™Âèó‰º§ÁöÑ‰øÆ‰ªôËÄÖÔºåÊïëÂä©ÂêéËé∑ÂæóÂ•ñÂä±', effect: 'good', type: 'help', cultivation: 50, reputation: 20 },
            { text: 'ÂèëÁé∞‰∏ÄÂ§ÑÁÅµÊ≥âÔºåÂê∏Êî∂ÁÅµÊ∞î‰øÆ‰∏∫Â§ßÂ¢û', effect: 'good', type: 'spring', cultivation: 80, health: 25 },
            { text: 'ÈÅáÂà∞Â¶ñÂÖΩË¢≠ÂáªÔºåÂèó‰∫Ü‰∫õ‰º§', effect: 'bad', type: 'beast', health: 18 },
            { text: 'Êç°Âà∞‰∏ÄÊú¨‰øÆÁÇºÁßòÁ±ç', effect: 'good', type: 'book', cultivation: 120 },
            { text: 'ÈÅ≠ÈÅá‰ªáÂÆ∂‰ºèÂáª', effect: 'bad', type: 'ambush', health: 25, reputation: 12 },
            { text: 'ÂèëÁé∞Â§©ÊùêÂú∞ÂÆù', effect: 'good', type: 'treasure', item: true },
            { text: 'ËØØÂÖ•Á¶ÅÂú∞ÔºåÂèóÂà∞ÂèçÂô¨', effect: 'bad', type: 'forbidden', health: 22, cultivation: 20 },
            { text: 'ÂèÇÂä†ÂÆóÈó®Â§ßÊØîÔºåËé∑ÂæóÂ®ÅÊúõ', effect: 'good', type: 'competition', reputation: 40 },
            { text: 'ÈÅ≠ÈÅáÂøÉÈ≠îÔºå‰øÆÁÇºÂèóÈòª', effect: 'bad', type: 'demon', cultivation: 25, health: 12 },
            { text: 'ÈÅáÂà∞‰ªô‰∫∫ÊåáË∑ØÔºåËé∑ÂæóÊÑüÊÇü', effect: 'good', type: 'immortal', cultivation: 100, maxCultivation: 25 },
            { text: 'ËøõÂÖ•ÂùäÂ∏ÇÔºåË¥≠‰π∞Âà∞ÁÅµ‰∏πÂ¶ôËçØ', effect: 'good', type: 'market', health: 35, cultivation: 30 },
            { text: 'ÈÅáÂà∞È´òÈò∂‰øÆÂ£´ÂàáÁ£ãÔºåËé∑ÁõäÂå™ÊµÖ', effect: 'good', type: 'sparring', cultivation: 60, reputation: 25 },
            { text: 'ÂèëÁé∞‰∏ÄÂ§ÑÂè§Ê¥ûÂ∫ú', effect: 'good', type: 'cave', cultivation: 90, reputation: 20 },
            { text: 'ÈÅ≠ÈÅá‰øÆ‰ªôÁïå‰∫âÊñóÔºåË¢´Ê≥¢Âèä', effect: 'bad', type: 'battle', health: 20 },
            { text: 'Êç°Âà∞‰ªñ‰∫∫ÈÅóÂ§±ÁöÑÂÇ®Áâ©Ë¢ã', effect: 'good', type: 'bag', reputation: 30 },
            { text: 'ÈÅáÂà∞‰∏πÂ∏àÔºåÂ≠¶‰π†ÁÇº‰∏π‰πãÈÅì', effect: 'good', type: 'alchemy', cultivation: 50, reputation: 15 },
            { text: 'ËøõÂÖ•ÁßòÂ¢ÉÔºåËé∑ÂæóÊú∫Áºò', effect: 'good', type: 'secret', cultivation: 100, health: 30, reputation: 25 },
            { text: 'ÈÅ≠ÈÅáÂ§©Âä´ËÄÉÈ™å', effect: 'bad', type: 'tribulation', health: 28, cultivation: 25 },
            { text: 'ÈÅáÂà∞Â¶ñÂÖΩÔºåÊàêÂäüÊñ©ÊùÄ', effect: 'good', type: 'beast_kill', reputation: 30, health: 15 },
            { text: 'ÂèëÁé∞ÁÅµËçØÂõ≠ÔºåÈááÊëòÁÅµËçØ', effect: 'good', type: 'herb', cultivation: 70, health: 25 },
            { text: 'ÈÅáÂà∞È≠î‰øÆÔºå‰∏ÄÁï™ÊøÄÊàò', effect: 'bad', type: 'demon_fight', health: 22, reputation: 18 },
            { text: 'ËøõÂÖ•ÊãçÂçñ‰ºöÔºåÊãçÂæóÂÆùÁâ©', effect: 'good', type: 'auction', reputation: 50, item: true },
            { text: 'ÂèëÁé∞‰∏äÂè§ÈÅóËøπ', effect: 'good', type: 'ruins', cultivation: 120, reputation: 30 },
            { text: 'ÈÅ≠ÈÅáÁ©∫Èó¥Ë£ÇÁºù', effect: 'bad', type: 'rift', health: 25, cultivation: 18 },
            { text: 'ÈÅáÂà∞Êï£‰øÆÂâçËæàÔºå‰º†ÊéàÂäüÊ≥ï', effect: 'good', type: 'loose_cultivator', method: true },
            { text: 'ÂèÇÂä†‰øÆ‰ªôÂ§ß‰ºöÔºåËé∑ÂæóËÆ§ÂèØ', effect: 'good', type: 'assembly', reputation: 55, cultivation: 40 },
            { text: 'ÂèëÁé∞ÁüøËÑâÔºåÂºÄÈááÁÅµÁü≥', effect: 'good', type: 'mine', reputation: 35 },
            { text: 'ÈÅ≠ÈÅáÂÖΩÊΩÆ', effect: 'bad', type: 'beast_wave', health: 30 },
            { text: 'ËøõÂÖ•ÂπªÂ¢ÉÔºåÁ£®ÁªÉÂøÉÂ¢É', effect: 'good', type: 'illusion', cultivation: 80, health: 8 }
        ];

        const cultivationTips = [
            'Â§©Âú∞ÁÅµÊ∞îÂÖ•‰ΩìÔºå‰∏πÁî∞ÂÖÖÁõà',
            'ÁÇºÁ≤æÂåñÊ∞îÔºå‰øÆ‰∏∫Á≤æËøõ',
            'ÂøÉÊó†ÊùÇÂøµÔºåÈÅìÂøÉÁ®≥Âõ∫',
            'ÂêêÁ∫≥Â§©Âú∞ÁÅµÊ∞îÔºåÁÇºÁ≤æÂåñÁ•û',
            'ÊÑüÊÇüÂ§©ÈÅìÔºåÁ™ÅÁ†¥Áì∂È¢à',
            'Èó≠ÂÖ≥‰øÆÁÇºÔºå‰øÆ‰∏∫Â§ßËøõ',
            'Ê∞îÊ≤â‰∏πÁî∞ÔºåËøêËΩ¨Âë®Â§©',
            'ÂáùÁ•ûËÅöÊ∞îÔºåÁ•ûÊÄùÊ∏ÖÊòé',
            'Èò¥Èò≥Ë∞ÉÂíåÔºåÊ∞îÊÅØÁªµÈïø',
            'ÂøÉÂ¶ÇÊ≠¢Ê∞¥ÔºåÈÅìÂøÉÂ¶ÇÈìÅ'
        ];

        function getMethodBonus(type) {
            const method = gameState.currentMethod ? methodDatabase.find(m => m.id === gameState.currentMethod) : null;
            if (!method) return 1;

            const level = gameState.methodLevels[gameState.currentMethod] || 1;
            const levelMultiplier = 1 + (level - 1) * 0.1;

            const bonuses = {
                cultivation: (method.cultivationBonus || 1) * levelMultiplier,
                age: method.ageBonus || 1,
                health: (method.healBonus || 1) * levelMultiplier,
                defense: method.defenseBonus || 1,
                explore: (method.exploreBonus || 1) * levelMultiplier,
                reputation: (method.reputationBonus || 1) * levelMultiplier,
                breakthrough: (method.breakthroughBonus || 1) * levelMultiplier
            };

            return bonuses[type] || 1;
        }

        function getItemBonuses() {
            let bonuses = {
                cultivation: 1,
                age: 1,
                health: 1,
                defense: 1,
                explore: 1,
                reputation: 1,
                breakthrough: 1,
                maxHealth: 0
            };

            gameState.equippedItems.forEach(item => {
                if (item.allBonus) {
                    bonuses.cultivation *= item.allBonus;
                    bonuses.explore *= item.allBonus;
                    bonuses.reputation *= item.allBonus;
                    bonuses.defense *= item.allBonus;
                } else {
                    if (item.cultivationBonus) bonuses.cultivation *= item.cultivationBonus;
                    if (item.ageBonus) bonuses.age *= item.ageBonus;
                    if (item.healBonus) bonuses.health *= item.healBonus;
                    if (item.defenseBonus) bonuses.defense *= item.defenseBonus;
                    if (item.exploreBonus) bonuses.explore *= item.exploreBonus;
                    if (item.reputationBonus) bonuses.reputation *= item.reputationBonus;
                    if (item.breakthroughBonus) bonuses.breakthrough *= item.breakthroughBonus;
                }
                if (item.healthBonus) bonuses.maxHealth += item.healthBonus;
            });

            return bonuses;
        }

        function getTotalBonus(type) {
            const methodBonus = getMethodBonus(type);
            const itemBonuses = getItemBonuses();
            return methodBonus * itemBonuses[type];
        }

        function updateUI() {
            const itemBonuses = getItemBonuses();
            const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;

            document.getElementById('health').textContent = `${gameState.health}/${maxHealthWithBonus}`;
            document.getElementById('health-bar').style.width = `${(gameState.health / maxHealthWithBonus) * 100}%`;
            document.getElementById('age').textContent = `${gameState.age}Â≤Å`;
            document.getElementById('age-bar').style.width = `${(gameState.age / gameState.maxAge) * 100}%`;
            document.getElementById('cultivation').textContent = gameState.cultivation;
            document.getElementById('cultivation-bar').style.width = `${(gameState.cultivation / gameState.maxCultivation) * 100}%`;
            document.getElementById('reputation').textContent = gameState.reputation;
            document.getElementById('realm').textContent = gameState.realmNames[gameState.realm];

            const currentMethod = gameState.currentMethod ? methodDatabase.find(m => m.id === gameState.currentMethod) : null;
            const currentLevel = gameState.currentMethod ? (gameState.methodLevels[gameState.currentMethod] || 1) : 1;
            document.getElementById('current-method').textContent = currentMethod ? `${currentMethod.name} (${currentLevel}Â±Ç)` : 'Êó†';

            document.getElementById('equipped-count').textContent = gameState.equippedItems.length;

            const slotsContainer = document.getElementById('equipment-slots');
            slotsContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const slot = document.createElement('div');
                slot.className = `equip-slot ${i < gameState.equippedItems.length ? 'occupied' : 'empty'}`;
                slot.textContent = i < gameState.equippedItems.length ? gameState.equippedItems[i].name : 'Á©∫';
                slotsContainer.appendChild(slot);
            }

            const totalCultivationBonus = getTotalBonus('cultivation');
            const totalExploreBonus = getTotalBonus('explore');
            const totalReputationBonus = getTotalBonus('reputation');
            const totalDefenseBonus = getTotalBonus('defense');
            const totalHealBonus = getTotalBonus('health');
            const totalBreakthroughBonus = getTotalBonus('breakthrough');
            const totalAgeBonus = getTotalBonus('age');
            const healthIncrease = itemBonuses.maxHealth;

            let bonusText = 'ÂΩìÂâçÂä†ÊàêÔºö';
            bonusText += `‰øÆ‰∏∫√ó${totalCultivationBonus.toFixed(1)} `;
            bonusText += `Êé¢Á¥¢√ó${totalExploreBonus.toFixed(1)} `;
            bonusText += `Â®ÅÊúõ√ó${totalReputationBonus.toFixed(1)} `;
            bonusText += `Âèó‰º§√ó${(totalDefenseBonus).toFixed(2)} `;
            bonusText += `Áñó‰º§√ó${totalHealBonus.toFixed(1)} `;
            bonusText += `Á™ÅÁ†¥√ó${totalBreakthroughBonus.toFixed(1)} `;
            bonusText += `ÂØøÂÖÉ√ó${totalAgeBonus.toFixed(2)} `;
            if (healthIncrease > 0) {
                bonusText += `<span>ÁîüÂëΩ+${healthIncrease}</span>`;
            }

            document.getElementById('bonus-display').innerHTML = bonusText;
        }

        function addLog(message, type = 'normal') {
            const logContent = document.getElementById('log-content');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = message;
            logContent.insertBefore(entry, logContent.firstChild);
            if (logContent.children.length > 20) {
                logContent.removeChild(logContent.lastChild);
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationContent = notification.querySelector('.notification-content');
            notificationContent.textContent = message;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 2000);
        }

        function showNewMethodAlert(method) {
            const alert = document.getElementById('new-item-alert');
            const title = alert.querySelector('.alert-title');
            const name = document.getElementById('alert-item-name');
            const desc = document.getElementById('alert-item-desc');

            title.textContent = 'üéâ ÊÅ≠ÂñúËé∑ÂæóÊñ∞ÂäüÊ≥ïÔºÅ';
            name.textContent = method.name;
            desc.textContent = method.desc;

            alert.classList.add('show');
        }

        function showNewItemAlert(item) {
            const alert = document.getElementById('new-item-alert');
            const title = alert.querySelector('.alert-title');
            const name = document.getElementById('alert-item-name');
            const desc = document.getElementById('alert-item-desc');

            title.textContent = 'üéÅ Ëé∑ÂæóÊñ∞Ê≥ïÂÆùÔºÅ';
            name.textContent = item.name;
            desc.textContent = item.desc;

            alert.classList.add('show');
        }

        function closeNewAlert() {
            document.getElementById('new-item-alert').classList.remove('show');
        }

        let currentEvent = null;

        function triggerInteractiveEvent() {
            if (gameState.isGameOver) return;

            const event = interactiveEvents[Math.floor(Math.random() * interactiveEvents.length)];
            currentEvent = event;

            document.getElementById('event-title').textContent = event.title;
            document.getElementById('event-description').textContent = event.description;

            const optionsContainer = document.getElementById('event-options');
            optionsContainer.innerHTML = '';

            event.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'event-option';
                optionDiv.onclick = () => handleEventChoice(index);

                let html = `<div class="event-option-text">${option.text}</div>`;
                if (option.riskText) {
                    html += `<div class="event-option-risk">‚ö†Ô∏è ${option.riskText}</div>`;
                }
                if (option.rewardText) {
                    html += `<div class="event-option-reward">‚ú® ${option.rewardText}</div>`;
                }

                optionDiv.innerHTML = html;
                optionsContainer.appendChild(optionDiv);
            });

            document.getElementById('event-modal').classList.add('show');
        }

        function handleEventChoice(choiceIndex) {
            const option = currentEvent.options[choiceIndex];
            document.getElementById('event-modal').classList.remove('show');

            const defenseBonus = getTotalBonus('defense');
            const exploreBonus = getTotalBonus('explore');
            const reputationBonus = getTotalBonus('reputation');
            const ageBonus = getTotalBonus('age');

            let damage = 0;
            let cultivationGain = 0;
            let reputationGain = 0;
            let healthGain = 0;
            let ageLoss = 0;
            let message = option.message;

            if (option.reward) {
                if (option.reward.cultivation) cultivationGain = Math.floor(option.reward.cultivation * exploreBonus);
                if (option.reward.reputation) reputationGain = Math.floor(option.reward.reputation * reputationBonus);
                if (option.reward.health) {
                    healthGain = Math.floor(option.reward.health * getTotalBonus('health'));
                }
                if (option.reward.method) {
                    let randomMethod;
                    do {
                        randomMethod = methodDatabase[Math.floor(Math.random() * methodDatabase.length)];
                    } while (gameState.learnedMethods.includes(randomMethod.id));
                    learnMethod(randomMethod);
                    showNewMethodAlert(randomMethod);
                    message += ` ‰π†Âæó${randomMethod.name}ÔºÅ`;
                }
                if (option.reward.item) {
                    const randomItem = itemDatabase[Math.floor(Math.random() * itemDatabase.length)];
                    addItem(randomItem);
                    showNewItemAlert(randomItem);
                    message += ` Ëé∑Âæó${randomItem.name}ÔºÅ`;
                }
            }

            if (option.risk) {
                if (option.risk.health) damage = Math.floor(option.risk.health * defenseBonus);
                if (option.risk.cultivation) gameState.cultivation = Math.max(0, gameState.cultivation - Math.floor(option.risk.cultivation * ageBonus));
                if (option.risk.reputation) gameState.reputation = Math.max(0, gameState.reputation - option.risk.reputation);
                if (option.risk.age) ageLoss = Math.floor(option.risk.age * ageBonus);
            }

            const itemBonuses = getItemBonuses();
            const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;

            gameState.health = Math.min(Math.max(0, gameState.health - damage + healthGain), maxHealthWithBonus);
            gameState.cultivation += cultivationGain;
            gameState.reputation += reputationGain;
            gameState.age += Math.floor(Math.random() * 1.5) + 0.5 + ageLoss;

            addLog(message, message.includes('Èáç‰º§') ? 'bad' : 'good');

            if (damage > 0) {
                addLog(`ÂèóÂà∞‰º§ÂÆ≥Ôºö-${damage}ÁîüÂëΩ`, 'bad');
            }
            if (cultivationGain > 0) {
                addLog(`‰øÆ‰∏∫Â¢ûÂä†Ôºö+${cultivationGain}`, 'good');
            }
            if (reputationGain > 0) {
                addLog(`Â®ÅÊúõÂ¢ûÂä†Ôºö+${reputationGain}`, 'good');
            }
            if (healthGain > 0) {
                addLog(`ÁîüÂëΩÊÅ¢Â§çÔºö+${healthGain}`, 'good');
            }
            if (ageLoss > 0) {
                addLog(`ÂØøÂÖÉÊ∂àËÄóÔºö-${ageLoss}Âπ¥`, 'bad');
            }

            if (gameState.cultivation >= gameState.maxCultivation) {
                attemptBreakthrough();
            }

            if (gameState.health <= 0) {
                gameOver('Âú®Êé¢Á¥¢‰∏≠Ë∫´ÂèóÈáç‰º§Ôºå‰∏çÂπ∏Èô®ËêΩ');
            } else if (gameState.age >= gameState.maxAge) {
                gameOver('ÂØøÂÖÉËÄóÂ∞ΩÔºåÂØøÁªàÊ≠£ÂØù');
            }

            updateUI();
        }

        function cultivate() {
            if (gameState.isGameOver) return;

            let baseGain = Math.floor(Math.random() * 30) + 20;
            const totalBonus = getTotalBonus('cultivation');
            const healthBonus = getTotalBonus('health');
            const gain = Math.floor(baseGain * totalBonus);

            gameState.cultivation += gain;

            const itemBonuses = getItemBonuses();
            const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;

            const baseHeal = Math.floor(Math.random() * 8) + 3;
            const heal = Math.floor(baseHeal * healthBonus);
            gameState.health = Math.min(gameState.health + heal, maxHealthWithBonus);

            if (gameState.cultivation >= gameState.maxCultivation) {
                attemptBreakthrough();
            } else {
                const tip = cultivationTips[Math.floor(Math.random() * cultivationTips.length)];
                addLog(`${tip}Ôºå‰øÆ‰∏∫+${gain}ÔºåÁîüÂëΩ+${heal}`, 'good');
            }

            checkAge();
            updateUI();
        }

        function practiceMethod() {
            if (gameState.isGameOver) return;

            if (!gameState.currentMethod) {
                showNotification('ËØ∑ÂÖàÈÄâÊã©‰∏ª‰øÆÂäüÊ≥ï');
                return;
            }

            const method = methodDatabase.find(m => m.id === gameState.currentMethod);
            const currentLevel = gameState.methodLevels[gameState.currentMethod] || 1;

            if (currentLevel >= 9) {
                showNotification('ÂäüÊ≥ïÂ∑≤‰øÆÁÇºËá≥ÂúÜÊª°');
                addLog(`${method.name}Â∑≤ËææÂúÜÊª°Â¢ÉÁïå`, 'special');
                return;
            }

            const successRate = 0.4 + (currentLevel * 0.05);
            const ageBonus = getTotalBonus('age');
            gameState.age += Math.floor(Math.random() * 1.2) + 0.8;

            if (Math.random() < successRate) {
                gameState.methodLevels[gameState.currentMethod] = currentLevel + 1;
                const newLevel = gameState.methodLevels[gameState.currentMethod];
                addLog(`ÊÅ≠ÂñúÔºÅ${method.name}Á™ÅÁ†¥Ëá≥${newLevel}Â±Ç`, 'special');
                showNotification(`${method.name}ÊèêÂçáËá≥${newLevel}Â±Ç`);
            } else {
                addLog(`‰øÆÁÇº${method.name}Êú™ËÉΩÁ™ÅÁ†¥`, 'normal');
            }

            if (gameState.age >= gameState.maxAge) {
                gameOver('ÂØøÂÖÉËÄóÂ∞ΩÔºåÂØøÁªàÊ≠£ÂØù');
            }

            updateUI();
        }

        function attemptBreakthrough() {
            const totalBonus = getTotalBonus('breakthrough');
            const successRate = 0.8 + (gameState.realm * 0.01);
            
            if (Math.random() < successRate * totalBonus) {
                gameState.realm++;
                gameState.maxCultivation = Math.floor(gameState.maxCultivation * 1.6);
                gameState.cultivation = 0;
                gameState.maxAge += 30;
                addLog(`ÊÅ≠ÂñúÔºÅÁ™ÅÁ†¥Âà∞${gameState.realmNames[gameState.realm]}ÔºÅÂØøÂÖÉ+30Âπ¥`, 'special');
                showNotification('Á™ÅÁ†¥ÊàêÂäüÔºÅ');
            } else {
                const defenseBonus = getTotalBonus('defense');
                gameState.cultivation = Math.floor(gameState.maxCultivation * 0.3);
                const damage = Math.floor(12 * defenseBonus);
                gameState.health -= damage;
                addLog(`Á™ÅÁ†¥Â§±Ë¥•ÔºåÂÖÉÊ∞îÂ§ß‰º§ÔºåÁîüÂëΩ-${damage}`, 'bad');
                if (gameState.health <= 0) {
                    gameOver('Á™ÅÁ†¥Â§±Ë¥•ÔºåËµ∞ÁÅ´ÂÖ•È≠îËÄåÊ≠ª');
                }
            }
            checkAge();
        }

        function explore() {
            if (gameState.isGameOver) return;

            const interactiveChance = 0.4;
            if (Math.random() < interactiveChance) {
                gameState.age += Math.floor(Math.random() * 1.5) + 0.5;
                triggerInteractiveEvent();
                return;
            }
            
            const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
            const defenseBonus = getTotalBonus('defense');
            const exploreBonus = getTotalBonus('explore');
            const reputationBonus = getTotalBonus('reputation');
            
            const ageBonus = getTotalBonus('age');
            gameState.age += Math.floor(Math.random() * 2) + 1;
            
            let damage = 0;
            let cultivationGain = 0;
            let reputationGain = 0;
            let healthGain = 0;

            if (event.health) damage = Math.floor(event.health * defenseBonus);
            if (event.cultivation) cultivationGain = Math.floor(event.cultivation * exploreBonus);
            if (event.reputation) reputationGain = Math.floor(event.reputation * reputationBonus);
            if (event.maxCultivation) gameState.maxCultivation += Math.floor(event.maxCultivation * exploreBonus);

            switch(event.type) {
                case 'help':
                    healthGain = event.health || 25;
                    reputationGain = event.reputation || 20;
                    addItem(itemDatabase[Math.floor(Math.random() * 3)]);
                    addLog(event.text + `ÔºåÁîüÂëΩ+${healthGain}ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåËé∑Âæó‰∏πËçØ`, 'good');
                    break;
                case 'spring':
                    cultivationGain = event.cultivation || 80;
                    healthGain = event.health || 25;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÁîüÂëΩ+${healthGain}`, 'good');
                    break;
                case 'beast':
                    damage = event.health || 18;
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}`, 'bad');
                    break;
                case 'book':
                    cultivationGain = event.cultivation || 120;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}`, 'good');
                    break;
                case 'ambush':
                    damage = event.health || 25;
                    const reputationLoss = event.reputation || 12;
                    gameState.reputation -= reputationLoss;
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}ÔºåÂ®ÅÊúõ-${reputationLoss}`, 'bad');
                    break;
                case 'treasure':
                    const treasureIndex = Math.floor(Math.random() * itemDatabase.length);
                    const treasureItem = itemDatabase[treasureIndex];
                    addItem(treasureItem);
                    showNewItemAlert(treasureItem);
                    addLog(event.text + `ÔºåËé∑Âæó${treasureItem.name}`, 'special');
                    break;
                case 'forbidden':
                    damage = event.health || 22;
                    const cultLoss = event.cultivation || 20;
                    gameState.cultivation = Math.max(0, gameState.cultivation - cultLoss);
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}Ôºå‰øÆ‰∏∫-${cultLoss}`, 'bad');
                    break;
                case 'competition':
                    reputationGain = event.reputation || 40;
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}`, 'good');
                    break;
                case 'demon':
                    const demLoss = event.cultivation || 25;
                    gameState.cultivation = Math.max(0, gameState.cultivation - demLoss);
                    damage = event.health || 12;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫-${demLoss}ÔºåÁîüÂëΩ-${damage}`, 'bad');
                    break;
                case 'immortal':
                    cultivationGain = event.cultivation || 100;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}`, 'special');
                    break;
                case 'market':
                    healthGain = event.health || 35;
                    cultivationGain = event.cultivation || 30;
                    addLog(event.text + `ÔºåÁîüÂëΩ+${healthGain}Ôºå‰øÆ‰∏∫+${cultivationGain}`, 'good');
                    break;
                case 'sparring':
                    cultivationGain = event.cultivation || 60;
                    reputationGain = event.reputation || 25;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÂ®ÅÊúõ+${reputationGain}`, 'good');
                    break;
                case 'cave':
                    cultivationGain = event.cultivation || 90;
                    reputationGain = event.reputation || 20;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÂ®ÅÊúõ+${reputationGain}`, 'good');
                    break;
                case 'battle':
                    damage = event.health || 20;
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}`, 'bad');
                    break;
                case 'bag':
                    reputationGain = event.reputation || 30;
                    addItem(itemDatabase[Math.floor(Math.random() * 6)]);
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåËé∑ÂæóÁâ©ÂìÅ`, 'good');
                    break;
                case 'alchemy':
                    cultivationGain = event.cultivation || 50;
                    reputationGain = event.reputation || 15;
                    addItem(itemDatabase[Math.floor(Math.random() * 3)]);
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåËé∑Âæó‰∏πËçØ`, 'good');
                    break;
                case 'secret':
                    cultivationGain = event.cultivation || 100;
                    healthGain = event.health || 30;
                    reputationGain = event.reputation || 25;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÁîüÂëΩ+${healthGain}ÔºåÂ®ÅÊúõ+${reputationGain}`, 'special');
                    break;
                case 'tribulation':
                    damage = event.health || 28;
                    const triLoss = event.cultivation || 25;
                    gameState.cultivation = Math.max(0, gameState.cultivation - triLoss);
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}Ôºå‰øÆ‰∏∫-${triLoss}`, 'bad');
                    break;
                case 'beast_kill':
                    reputationGain = event.reputation || 30;
                    healthGain = event.health || 15;
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåÁîüÂëΩ+${healthGain}`, 'good');
                    break;
                case 'herb':
                    cultivationGain = event.cultivation || 70;
                    healthGain = event.health || 25;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÁîüÂëΩ+${healthGain}`, 'good');
                    break;
                case 'demon_fight':
                    damage = event.health || 22;
                    reputationGain = event.reputation || 18;
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}ÔºåÂ®ÅÊúõ+${reputationGain}`, 'bad');
                    break;
                case 'auction':
                    reputationGain = event.reputation || 50;
                    const auctionItem = itemDatabase[4 + Math.floor(Math.random() * 26)];
                    addItem(auctionItem);
                    showNewItemAlert(auctionItem);
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåËé∑ÂæóÊ≥ïÂÆù`, 'special');
                    break;
                case 'ruins':
                    cultivationGain = event.cultivation || 120;
                    reputationGain = event.reputation || 30;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÂ®ÅÊúõ+${reputationGain}`, 'special');
                    break;
                case 'rift':
                    damage = event.health || 25;
                    const riftLoss = event.cultivation || 18;
                    gameState.cultivation = Math.max(0, gameState.cultivation - riftLoss);
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}Ôºå‰øÆ‰∏∫-${riftLoss}`, 'bad');
                    break;
                case 'loose_cultivator':
                    let randomMethod;
                    do {
                        randomMethod = methodDatabase[Math.floor(Math.random() * methodDatabase.length)];
                    } while (gameState.learnedMethods.includes(randomMethod.id));
                    learnMethod(randomMethod);
                    showNewMethodAlert(randomMethod);
                    addLog(event.text + `Ôºå‰π†Âæó${randomMethod.name}`, 'special');
                    break;
                case 'assembly':
                    reputationGain = event.reputation || 55;
                    cultivationGain = event.cultivation || 40;
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}Ôºå‰øÆ‰∏∫+${cultivationGain}`, 'good');
                    break;
                case 'mine':
                    reputationGain = event.reputation || 35;
                    addItem(itemDatabase[5]);
                    addLog(event.text + `ÔºåÂ®ÅÊúõ+${reputationGain}ÔºåËé∑ÂæóÁÅµÁü≥`, 'good');
                    break;
                case 'beast_wave':
                    damage = event.health || 30;
                    addLog(event.text + `ÔºåÁîüÂëΩ-${damage}`, 'bad');
                    break;
                case 'illusion':
                    cultivationGain = event.cultivation || 80;
                    healthGain = event.health || 8;
                    addLog(event.text + `Ôºå‰øÆ‰∏∫+${cultivationGain}ÔºåÁîüÂëΩ+${healthGain}`, 'good');
                    break;
            }
            
            const itemBonuses = getItemBonuses();
            const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;
            gameState.health = Math.min(Math.max(0, gameState.health - damage + healthGain), maxHealthWithBonus);
            gameState.cultivation += cultivationGain;
            gameState.reputation += reputationGain;
            
            if (gameState.cultivation >= gameState.maxCultivation) {
                attemptBreakthrough();
            }
            
            if (gameState.health <= 0) {
                gameOver('Âú®Êé¢Á¥¢‰∏≠Ë∫´ÂèóÈáç‰º§Ôºå‰∏çÂπ∏Èô®ËêΩ');
            } else if (gameState.age >= gameState.maxAge) {
                gameOver('ÂØøÂÖÉËÄóÂ∞ΩÔºåÂØøÁªàÊ≠£ÂØù');
            }
            
            updateUI();
        }

        function rest() {
            if (gameState.isGameOver) return;
            
            let baseHeal = Math.floor(Math.random() * 30) + 18;
            const totalBonus = getTotalBonus('health');
            const heal = Math.floor(baseHeal * totalBonus);
            
            const ageBonus = getTotalBonus('age');
            gameState.age += Math.floor(Math.random() * 1.5) + 0.5;
            
            const itemBonuses = getItemBonuses();
            const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;
            gameState.health = Math.min(gameState.health + heal, maxHealthWithBonus);
            addLog(`Ë∞ÉÊÅØÁñó‰º§ÔºåÊÅ¢Â§ç${heal}ÁÇπÁîüÂëΩ`, 'good');
            
            if (gameState.age >= gameState.maxAge) {
                gameOver('ÂØøÂÖÉËÄóÂ∞ΩÔºåÂØøÁªàÊ≠£ÂØù');
            }
            
            updateUI();
        }

        function addItem(item) {
            gameState.items.push({...item});
        }

        function learnMethod(method) {
            if (!gameState.learnedMethods.includes(method.id)) {
                gameState.learnedMethods.push(method.id);
            }
        }

        function showItems() {
            const itemsList = document.getElementById('items-list');
            itemsList.innerHTML = '';
            
            if (gameState.items.length === 0) {
                itemsList.innerHTML = '<div style="text-align:center; color:#888; padding: 20px;">ËÉåÂåÖ‰∏∫Á©∫</div>';
            } else {
                gameState.items.forEach((item, index) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'item';
                    
                    const isEquipped = gameState.equippedItems.some(ei => ei.id === item.id);
                    const equippedClass = isEquipped ? 'equipped' : '';
                    
                    let effectText = '';
                    if (item.exploreBonus) effectText += `Êé¢Á¥¢Êî∂Áõä+${Math.round((item.exploreBonus - 1) * 100)}% `;
                    if (item.defenseBonus) effectText += `Âèó‰º§ÂáèÂ∞ë${Math.round((1 - item.defenseBonus) * 100)}% `;
                    if (item.cultivationBonus) effectText += `‰øÆ‰∏∫Ëé∑Âèñ+${Math.round((item.cultivationBonus - 1) * 100)}% `;
                    if (item.reputationBonus) effectText += `Â®ÅÊúõËé∑Âèñ+${Math.round((item.reputationBonus - 1) * 100)}% `;
                    if (item.breakthroughBonus) effectText += `Á™ÅÁ†¥ÊàêÂäüÁéá+${Math.round((item.breakthroughBonus - 1) * 100)}% `;
                    if (item.healthBonus) effectText += `ÁîüÂëΩ‰∏äÈôê+${item.healthBonus} `;
                    if (item.allBonus) effectText += `ÂÖ®Â±ûÊÄß+${Math.round((item.allBonus - 1) * 100)}% `;
                    
                    itemDiv.innerHTML = `
                        <div class="item-header">
                            <div class="item-name ${equippedClass}">${item.name}${isEquipped ? ' (Â∑≤Ë£ÖÂ§á)' : ''}</div>
                        </div>
                        <div class="item-desc">${item.desc}</div>
                        ${effectText ? `<div class="item-effects">${effectText}</div>` : ''}
                        <div class="btn-group">
                            ${item.effect === 'equip' ? 
                                `<button class="equip-btn" onclick="equipItem(${index})">${isEquipped ? 'Âç∏‰∏ã' : 'Ë£ÖÂ§á'}</button>` :
                                `<button class="use-btn" onclick="useItem(${index})">‰ΩøÁî®</button>`
                            }
                        </div>
                    `;
                    itemsList.appendChild(itemDiv);
                });
            }
            
            document.getElementById('items-modal').classList.add('show');
        }

        function equipItem(index) {
            const item = gameState.items[index];
            
            const equippedIndex = gameState.equippedItems.findIndex(ei => ei.id === item.id);
            if (equippedIndex !== -1) {
                gameState.equippedItems.splice(equippedIndex, 1);
                addLog(`Âç∏‰∏ã${item.name}`, 'normal');
            } else {
                if (item.effect === 'equip' && gameState.equippedItems.length < 10) {
                    gameState.equippedItems.push(item);
                    addLog(`Ë£ÖÂ§á${item.name}`, 'good');
                    showNotification(`Â∑≤Ë£ÖÂ§á${item.name}`);
                } else if (gameState.equippedItems.length >= 10) {
                    showNotification('ÊúÄÂ§öË£ÖÂ§á10‰ª∂Ê≥ïÂÆù');
                    return;
                }
            }
            
            showItems();
            updateUI();
        }

        function useItem(index) {
            const item = gameState.items[index];
            
            switch(item.effect) {
                case 'health':
                    const itemBonuses = getItemBonuses();
                    const maxHealthWithBonus = gameState.maxHealth + itemBonuses.maxHealth;
                    gameState.health = Math.min(gameState.health + item.value, maxHealthWithBonus);
                    addLog(`‰ΩøÁî®${item.name}ÔºåÊÅ¢Â§ç${item.value}ÁÇπÁîüÂëΩ`, 'good');
                    break;
                case 'cultivation':
                    gameState.cultivation += item.value;
                    addLog(`‰ΩøÁî®${item.name}Ôºå‰øÆ‰∏∫+${item.value}`, 'good');
                    if (gameState.cultivation >= gameState.maxCultivation) {
                        attemptBreakthrough();
                    }
                    break;
                case 'age':
                    gameState.maxAge += item.value;
                    addLog(`‰ΩøÁî®${item.name}ÔºåÂØøÂÖÉ+${item.value}Âπ¥`, 'special');
                    break;
                case 'wealth':
                    gameState.reputation += item.reputationBonus || 60;
                    addLog(`‰ΩøÁî®${item.name}ÔºåÂ®ÅÊúõ+${item.reputationBonus || 60}`, 'good');
                    break;
                default:
                    addLog(`Ëé∑Âæó${item.name}`, 'normal');
            }
            
            gameState.items.splice(index, 1);
            showItems();
            updateUI();
        }

        function showMethods() {
            const methodsList = document.getElementById('methods-list');
            methodsList.innerHTML = '';
            
            const sortedMethods = [...methodDatabase].sort((a, b) => {
                const aLearned = gameState.learnedMethods.includes(a.id);
                const bLearned = gameState.learnedMethods.includes(b.id);
                if (aLearned && !bLearned) return -1;
                if (!aLearned && bLearned) return 1;
                return a.id - b.id;
            });

            sortedMethods.forEach(method => {
                const methodDiv = document.createElement('div');
                const isActive = gameState.currentMethod === method.id;
                const isLearned = gameState.learnedMethods.includes(method.id);
                const level = gameState.methodLevels[method.id] || 1;

                methodDiv.className = `method ${isActive ? 'active' : ''}`;

                let effectText = method.effects.map(e => e).join('Ôºå');
                const levelText = isLearned ? ` <span style="color: #ffd700; font-weight: bold;">${level}Â±Ç</span>` : '';

                const header = document.createElement('div');
                header.className = 'method-section';
                header.innerHTML = `
                    <div class="method-name">${method.name}${isActive ? ' (ÂΩìÂâç‰øÆÁÇº)' : ''}${levelText}</div>
                    ${isLearned ? '<span class="method-badge">Â∑≤‰π†Âæó</span>' : ''}
                `;

                methodDiv.appendChild(header);

                const desc = document.createElement('div');
                desc.className = 'method-desc';
                desc.textContent = method.desc;
                methodDiv.appendChild(desc);

                const effects = document.createElement('div');
                effects.className = 'item-effects';
                effects.textContent = effectText;
                methodDiv.appendChild(effects);

                if (isLearned) {
                    if (level < 9) {
                        const levelProgress = document.createElement('div');
                        levelProgress.style.color = '#888';
                        levelProgress.style.fontSize = '0.8rem';
                        levelProgress.style.marginTop = '5px';
                        levelProgress.textContent = `ÂΩìÂâçÂ±ÇÊï∞Ôºö${level}/9Â±ÇÔºåÊØèÂ±ÇÊèêÂçá10%ÊïàÊûú`;
                        methodDiv.appendChild(levelProgress);
                    } else {
                        const maxLevel = document.createElement('div');
                        maxLevel.style.color = '#4CAF50';
                        maxLevel.style.fontSize = '0.8rem';
                        maxLevel.style.marginTop = '5px';
                        maxLevel.textContent = 'ÂäüÊ≥ïÂ∑≤ÂúÜÊª°ÔºåÊïàÊûúÊèêÂçá80%';
                        methodDiv.appendChild(maxLevel);
                    }

                    const btn = document.createElement('button');
                    btn.className = 'select-btn';
                    btn.textContent = isActive ? '‰øÆÁÇº‰∏≠' : 'ÈÄâÊã©‰øÆÁÇº';
                    btn.onclick = () => selectMethod(method.id);
                    methodDiv.appendChild(btn);
                } else {
                    const notLearned = document.createElement('div');
                    notLearned.style.color = '#888';
                    notLearned.style.fontSize = '0.85rem';
                    notLearned.style.marginTop = '5px';
                    notLearned.textContent = 'Êú™‰π†Âæó - ÈÄöËøáÊé¢Á¥¢Ëé∑Âæó';
                    methodDiv.appendChild(notLearned);
                }

                methodsList.appendChild(methodDiv);
            });
            
            document.getElementById('methods-modal').classList.add('show');
        }

        function selectMethod(methodId) {
            if (gameState.learnedMethods.includes(methodId)) {
                const method = methodDatabase.find(m => m.id === methodId);
                gameState.currentMethod = methodId;
                if (!gameState.methodLevels[methodId]) {
                    gameState.methodLevels[methodId] = 1;
                }
                const level = gameState.methodLevels[methodId];
                addLog(`ÂºÄÂßã‰øÆÁÇº${method.name}Ôºà${level}Â±ÇÔºâ`, 'good');
                showNotification(`Â∑≤ÂàáÊç¢Ëá≥${method.name}`);
                showMethods();
                updateUI();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function checkAge() {
            const ageBonus = getTotalBonus('age');
            gameState.age += Math.floor(Math.random() * 1.5) + 0.5;
            if (gameState.age >= gameState.maxAge) {
                gameOver('ÂØøÂÖÉËÄóÂ∞ΩÔºåÂØøÁªàÊ≠£ÂØù');
            }
        }

        function gameOver(reason) {
            gameState.isGameOver = true;
            const container = document.querySelector('.container');
            container.innerHTML = `
                <div class="game-over">
                    <h2>Ê∏∏ÊàèÁªìÊùü</h2>
                    <p>${reason}</p>
                    <p>ÊúÄÁªàÂ¢ÉÁïå: ${gameState.realmNames[gameState.realm]}</p>
                    <p>‰øÆ‰∏∫: ${gameState.cultivation}</p>
                    <p>Â®ÅÊúõ: ${gameState.reputation}</p>
                    <p>‰øÆÂæóÂäüÊ≥ï: ${gameState.learnedMethods.length}Áßç</p>
                    <button class="restart-btn" onclick="restartGame()">ÈáçÊñ∞ÂºÄÂßã</button>
                </div>
            `;
        }

        function restartGame() {
            gameState.health = 100;
            gameState.maxHealth = 100;
            gameState.age = 16;
            gameState.maxAge = 150;
            gameState.cultivation = 0;
            gameState.maxCultivation = 100;
            gameState.reputation = 0;
            gameState.realm = 0;
            gameState.items = [];
            gameState.equippedItems = [];
            gameState.currentMethod = null;
            gameState.learnedMethods = [1];
            gameState.methodLevels = { 1: 1 };
            gameState.isGameOver = false;

            location.reload();
        }

        gameState.learnedMethods.push(1);
        gameState.methodLevels[1] = 1;
        addLog('Ê¨¢ËøéÊù•Âà∞‰øÆ‰ªô‰∏ñÁïåÔºÅË∏è‰∏ä‰øÆ‰ªô‰πãË∑ØÔºåËøΩÊ±ÇÈïøÁîü‰∏çËÄÅ‰πãÈÅì„ÄÇ', 'special');
        addLog('ÂàùÂßãÂ∑≤‰π†Âæó"Âü∫Á°ÄÂêêÁ∫≥Ê≥ï"ÔºåÂèØÂú®ÂäüÊ≥ïÂõæÈâ¥‰∏≠Êü•Áúã', 'special');
        addLog('ÁÇπÂáª"‰øÆÁÇºÂäüÊ≥ï"ÂèØ‰ª•ÊèêÂçáÂäüÊ≥ïÂ±ÇÊï∞ÔºåÊúÄÈ´ò9Â±Ç', 'special');
        updateUI();
    </script>
</body>
</html>